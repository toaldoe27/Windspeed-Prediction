"0","# Sort the output dataframe by latitude and longitude."
"0","w_sample <- arrange(w_sample, lat, long)"
"0",""
"0","# Interpolate missing values using periods before and after"
"0","# Loop through each unique combination of lat and long"
"0","for (g1 in unique(w_sample$lat)) {"
"0","  for (g2 in unique(w_sample$long[w_sample$lat == g1])) {"
"0","    # Subset data frame to current combination"
"0","    sub_w_sample <- w_sample %>%"
"0","      filter(lat == g1 & long == g2)"
"0","    # Interpolate missing values in the column"
"0","    for (col in c(""TSK"", ""PSFC"", ""U10"", ""V10"", ""Q2"", ""RAINC"", ""RAINNC"", ""SNOW"", ""TSLB"", ""SMOIS"")) {"
"0","      sub_w_sample[[col]] <- na_interpolation(sub_w_sample[[col]], option = ""stine"", maxgap = 3)"
"0","      # Replace original values with interpolated values in the original data frame"
"0","      w_sample[w_sample$lat == g1 & w_sample$long == g2, col] <- sub_w_sample[[col]]"
"0","    }"
"0","  }"
"0","}"
"0",""
"0","# Re-check for any missing values"
"0","colSums(is.na(w_sample))"
"1","     lat "
"1","    long "
"1","     TSK "
"1","    PSFC "
"1","     U10 "
"1","     V10 "
"1","      Q2 "
"1","   RAINC "
"1","  RAINNC "
"1","    SNOW "
"1","
"
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","       0 "
"1","
"
"1","    TSLB "
"1","   SMOIS "
"1","datetime "
"1","
"
"1","       0 "
"1","       0 "
"1","       0 "
"1","
"
"0","sum(is.na(w_sample))"
"1","[1]"
"1"," 0"
"1","
"

"0","# Group the data frame by latitude and longitude, calculate the mean for each variable within each group, and add the results as columns"
"0","avg_data <- wsample_new %>% "
"0","  group_by(lat, long) %>% "
"0","  summarize(across(c(""TSK"", ""PSFC"", ""Q2"", ""RAINC"", ""RAINNC"", ""SNOW"", ""TSLB"", ""SMOIS"", ""wind_speed""), mean))"
"2","`summarise()` has grouped output by 'lat'. You can override using the `.groups` argument."
"0","# Find the row index of the maximum average value for each variable within each group"
"0","max_avg_row <- sapply(avg_data[,c(""TSK"", ""PSFC"", ""Q2"", ""RAINC"", ""RAINNC"", ""SNOW"", ""TSLB"", ""SMOIS"", ""wind_speed"")], which.max)"
"1","       TSK "
"1","      PSFC "
"1","        Q2 "
"1","
"
"1","        75 "
"1","       255 "
"1","         9 "
"1","        52 "
"1","       160 "
"1","         1 "
"1","        75 "
"1","         9 "
"1","
"
"1","wind_speed "
"1","
"
"1","       274 "
"1","
"
"0","# Extract the latitude and longitude values for each maximum"
"0","max_avg_location <- avg_data[max_avg_row, c(""lat"", ""long"")]"
"0",""
"0","# Print the result"
"0","cat(""Location with highest average values:\n"")"
"1","Location with highest average values:
"
"0","print(max_avg_location)"
